{"name":"Dataflow 1","ppdf:dataflowId":"e28732e7-726e-4cdb-aaed-b992bf099825","ppdf:owner":{"tenantId":"ce57ebe3-a63d-4708-b5cf-c274b48bd26c","userId":"cf150052-42b6-4237-91a2-03b01f5a87e6"},"ppdf:fastCopy":true,"version":"1.0","culture":"en-US","modifiedTime":"2024-10-19T19:49:26.516295+00:00","ppdf:outputFileFormat":"Parquet","pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"DefaultDestination":{"queryId":"46ab3e5f-38c7-48ed-aecd-e8741c01828c","queryName":"DefaultDestination"},"orders":{"queryId":"1bdf6b9b-7b0c-4516-ab28-6e185634d4bc","queryName":"orders"},"orders_DataDestination":{"queryId":"6a751c5b-e500-4a7f-ac57-b0d26cdcf5a1","queryName":"orders_DataDestination"},"orders_WriteToDataDestination":{"queryId":"74191d66-d295-4d31-b0bd-2bcb20db5c0f","queryName":"orders_WriteToDataDestination"},"orders_TransformForWriteToDataDestination":{"queryId":"00c58651-4667-48c6-8c0b-0d2a22b05279","queryName":"orders_TransformForWriteToDataDestination"},"FastCopyStaging":{"queryId":"d899b9be-0572-4b74-897b-f2723ce9733d","queryName":"FastCopyStaging"}},"document":"section Section1;\r\nshared DefaultDestination = let\r\n  DefaultDestination = Lakehouse.Contents(null){[workspaceId = \"994173ed-3749-4ced-ae97-b882c5727abf\"]}[Data]{[lakehouseId = \"3706bf00-d138-4354-b049-c138f7ebee10\"]}[Data]\r\nin\r\n  DefaultDestination;\r\nshared orders = let\r\n  Source = Csv.Document(Web.Contents(\"https://raw.githubusercontent.com/MicrosoftLearning/dp-data/main/orders.csv\"), [Delimiter = \",\", Columns = 7, QuoteStyle = QuoteStyle.None]),\r\n  #\"Promoted headers\" = Table.PromoteHeaders(Source, [PromoteAllScalars = true]),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Promoted headers\", {{\"SalesOrderID\", Int64.Type}, {\"OrderDate\", type date}, {\"CustomerID\", Int64.Type}, {\"LineItem\", Int64.Type}, {\"ProductID\", Int64.Type}, {\"OrderQty\", Int64.Type}, {\"LineItemTotal\", type number}}),\r\n  #\"Added custom\" = Table.TransformColumnTypes(Table.AddColumn(#\"Changed column type\", \"MonthNo\", each Date.Month([OrderDate])), {{\"MonthNo\", Int64.Type}})\r\nin\r\n  #\"Added custom\";\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\nshared orders_DataDestination = let\r\n  Pattern = Lakehouse.Contents([CreateNavigationProperties = false]),\r\n  Navigation_1 = Pattern{[workspaceId = \"994173ed-3749-4ced-ae97-b882c5727abf\"]}[Data],\r\n  Navigation_2 = Navigation_1{[lakehouseId = \"3706bf00-d138-4354-b049-c138f7ebee10\"]}[Data],\r\n  TableNavigation = Navigation_2{[Id = \"orders\", ItemKind = \"Table\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[SalesOrderID = nullable Int64.Type, OrderDate = nullable Date.Type, CustomerID = nullable Int64.Type, LineItem = nullable Int64.Type, ProductID = nullable Int64.Type, OrderQty = nullable Int64.Type, LineItemTotal = nullable Number.Type, MonthNo = nullable Int64.Type], {}), [DeleteWhenEmpty = false])\r\nin\r\n  Table;\r\n[Staging = \"FastCopyStaging\"]\r\nshared orders_WriteToDataDestination = let\r\n  orders_WriteToDataDestination = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = orders_DataDestination], (txn) => {TableAction.InsertRows(txn[Target], orders_TransformForWriteToDataDestination), Action.DoNothing}))\r\nin\r\n  orders_WriteToDataDestination;\r\nshared orders_TransformForWriteToDataDestination = let\r\n    SourceTable = Table.SelectColumns(orders, {\"SalesOrderID\", \"OrderDate\", \"CustomerID\", \"LineItem\", \"ProductID\", \"OrderQty\", \"LineItemTotal\", \"MonthNo\"})\r\nin\r\n    SourceTable;\r\nshared FastCopyStaging = let\r\n  FastCopyStaging = Pipeline.FastCopyModelStorage(DefaultStaging, [Required = false])\r\nin\r\n  FastCopyStaging;\r\n","connectionOverrides":[{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null},{"path":"https://raw.githubusercontent.com/MicrosoftLearning/dp-data/main/orders.csv","kind":"Web","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Web\",\"path\":\"https://raw.githubusercontent.com/MicrosoftLearning/dp-data/main/orders.csv\"}","audience":null}]}}